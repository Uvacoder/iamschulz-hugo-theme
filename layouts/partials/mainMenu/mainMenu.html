<nav data-component="mainMenu" class="main-menu">
    <input type="checkbox" id="mainMenuCheck" class="main-menu__check" data-main-menu-el="checkbox">
    <ul class="main-menu__list" data-main-menu-el="menuList">
        {{ $currentPage := . }}

        {{ range $key, $value := .Site.Taxonomies.categories }}
            {{ $url := print "/categories/" ($key | urlize) "/"  | absURL }}
            {{ $childIsActive := false }}
            {{ range $entry := $value }}
                {{ if eq ($entry.Permalink) ($currentPage.Permalink) }}
                    {{ $childIsActive = true }}
                {{ end }}
            {{ end }}
            {{ $active := or $childIsActive (eq ($url) ($currentPage.Permalink))}}

            <li class="main-menu__item">
                <a 
                    href="{{ $url }}"
                    class="main-menu__link{{ if $active }} active{{ end }}"
                >{{ $key | humanize }}</a>
            </li>
        {{ end }}
        
        {{ range .Site.Pages }}
            {{ if and (eq .Type "page") (eq .Kind "page")}}
                <li class="main-menu__item">
                    <a 
                        href="{{ .Permalink }}"
                        class="main-menu__link{{ if eq (.Permalink) ($currentPage.Permalink) }} active{{ end }}"
                    >{{ .Title }}</a>
                </li>
            {{ end }}
        {{ end }}
        <li class="main-menu__additional-items">
            <ul class="main-menu__additional-list">
                <li class="main-menu__additional-item">
                    {{ partial "colorSchemeToggle/colorSchemeToggle.html" . }}
                </li>
            </ul>
        </li>
    </ul>
</nav>